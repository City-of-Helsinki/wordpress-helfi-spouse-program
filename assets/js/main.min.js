function spouse_focus(e){var t=e.target.classList[0].substr(-1),n=jQuery("#wow-modal-window-"+t).find("input[type=text]").first();setTimeout(function(){n.focus()},1e3)}function isValidUrl(e){try{new URL(e)}catch(e){return!1}return!0}function addExternalLinkStyling(e){0===jQuery(e).parents(".share, .service-link").length&&(e.classList.add("external-link"),addExternalLinkIcon(e))}function addExternalLinkIcon(e){null===e.querySelector(".inline-svg")&&(jQuery(e).append('<span class="inline-svg rotate-45"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32.6 32.1" xml:space="preserve" role="presentation"><path style="fill-rule:evenodd;clip-rule:evenodd" d="M32.6 16.1 16.5 0l-2.8 2.8 11.4 11.3H0v4h25L13.7 29.3l2.8 2.8z"></path></svg></span>'),jQuery(e).append('<span class="visually-hidden" lang="fi" dir="ltr">(Link leads to external service)</span>'))}function addInternalLinkIcon(e){null===e.querySelector(".inline-svg")&&jQuery(e).append('<span class="inline-svg rotate-0"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32.6 32.1" xml:space="preserve" role="presentation"><path style="fill-rule:evenodd;clip-rule:evenodd" d="M32.6 16.1 16.5 0l-2.8 2.8 11.4 11.3H0v4h25L13.7 29.3l2.8 2.8z"></path></svg></span>')}function detectExternalLinks(e){const t=window.location.hostname,n=document.querySelectorAll(e);for(let e=0;e<n.length;e++)if(isValidUrl(n[e])){let a=new URL(n[e]).hostname.replace("www.","");var o=n[e].getElementsByTagName("img");!a||t===a||a.includes("spouseprogram.fi")||n[e].classList.contains("venobox")||n[e].classList.contains("fancybox-youtube")||n[e].classList.contains("button")||o.length?n[e].classList.contains("arrow")&&addInternalLinkIcon(n[e]):addExternalLinkStyling(n[e])}}function highlightedContentHelperClass(e){const t=document.querySelectorAll(e);for(let e=0;e<t.length;e++){const n=t[e].outerHTML;n.startsWith("<p><a")||n.startsWith("<p><strong><a")||n.startsWith("<p><i><a")||jQuery(t[e]).prepend("<span></span>")}}function loadMoreContent(e){const{buttonId:t,actionType:n}={events:{buttonId:"load-more-events",actionType:"spouse_load_more_events"},newsletters:{buttonId:"load-more-newsletters",actionType:"spouse_load_more_newsletters"}}[e]||{},o=document.getElementById(t);if(!o)return;let a=parseInt(o.dataset.paged)+1,s=o.dataset.taxonomy||"all";fetch(spouseAjax.ajaxurl,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({action:n,paged:a,taxonomy:s})}).then(e=>e.json()).then(e=>{e.success&&e.data.html&&(document.querySelector("#load-more-container").insertAdjacentHTML("beforeend",e.data.html),o.dataset.paged=a,e.data.has_more||(o.style.display="none"))}).catch(e=>console.error("Error with AJAX request:",e))}function filterEventsByTaxonomy(e){const t=new URL(window.location.href);t.searchParams.set("taxonomy",e),window.location.href=t}jQuery("document").ready(function(){detectExternalLinks("#main-content a"),highlightedContentHelperClass("#main-content .highlighted-content p"),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault(),document.querySelector(this.getAttribute("href")).scrollIntoView({behavior:"smooth"})})}),jQuery("[class*=wow-modal-id-]").each(function(e,t){jQuery(this).closest("a").length&&jQuery(this).on("click",spouse_focus)}),document.addEventListener("wpcf7mailsent",function(e){location=mainVars.thankYouPage},!1)}),document.addEventListener("DOMContentLoaded",()=>{document.querySelectorAll(".taxonomy-filter-button").forEach(e=>{e.addEventListener("click",()=>{filterEventsByTaxonomy(e.dataset.filter)})}),document.addEventListener("click",e=>{e.target.matches("#load-more-events, #load-more-newsletters")&&(e.preventDefault(),loadMoreContent(e.target.id.includes("events")?"events":"newsletters"))}),document.querySelectorAll(".year-toggle").forEach(e=>{e.addEventListener("click",()=>{const t=e.dataset.year,n=document.getElementById(`year-${t}`);e.querySelector(".arrow");document.querySelectorAll(".year-content").forEach(e=>e.style.display=e===n&&"block"!==e.style.display?"block":"none"),document.querySelectorAll(".year-toggle").forEach(t=>{const o=t.querySelector(".arrow");t.classList.toggle("active",t===e&&"block"===n.style.display),o.classList.toggle("arrow-up",t===e&&"block"===n.style.display),o.classList.toggle("arrow-down",!(t===e&&"block"===n.style.display))})})}),document.getElementById("skip-to-main-content")?.addEventListener("click",e=>{e.preventDefault();const t=document.getElementById("main-content");if(!t)return;const n=document.querySelector("h1, h2, h3, h4, h5, h6")||t;n.setAttribute("tabindex","-1"),n.focus()})});